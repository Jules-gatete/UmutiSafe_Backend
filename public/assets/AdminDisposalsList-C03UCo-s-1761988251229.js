import{r as l,j as n,L as u}from"./vendor_react-CK1M0B1O-1761988251229.js";import{T as b}from"./Table-p0UcKWoY-1761988251229.js";import{b as o}from"./index-BPH-ltX_-1761988251229.js";import"./vendor_misc-i1ZNofER-1761988251229.js";import"./vendor_axios-ngrFHoWO-1761988251229.js";function q(){const[p,m]=l.useState([]),[k,x]=l.useState(!0),c=(s,e="Not provided")=>s==null||s===""?e:s;l.useEffect(()=>{(async()=>{try{const[e,i]=await Promise.all([o.getDisposals(),o.getPickups()]),r=e&&e.success?e.data:e?.data??[],d=i&&i.success?i.data:i?.data??[],a={};(d||[]).forEach(t=>{t.id&&(a[String(t.id)]=t),t._id&&(a[String(t._id)]=t),t.pickupRequestId&&(a[String(t.pickupRequestId)]=t),t.pickup_request_id&&(a[String(t.pickup_request_id)]=t)});const y=(r||[]).map(t=>({...t,pickupRequest:a[String(t.pickupRequestId)]??a[String(t.pickup_request_id)]??a[String(t.pickup_request)]??a[String(t.id)]??a[String(t._id)]??t.pickupRequest??t.pickup_request??null}));m(y)}catch(e){console.error("Failed to load admin disposals",e)}finally{x(!1)}})()},[]);const g=[{key:"id",label:"ID"},{key:"genericName",label:"Medicine",render:(s,e)=>{const i=e.genericName||e.generic_name||e.medicine_name||null,r=e.brandName||e.brand_name||null;return n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:c(i,"Unnamed medicine")}),r?n.jsx("div",{className:"text-sm text-gray-600",children:r}):null]})}},{key:"dosageForm",label:"Form",render:s=>c(s,"Unknown form")},{key:"predictedCategory",label:"Predicted Cat",render:s=>c(s,"Not predicted")},{key:"riskLevel",label:"Risk",render:s=>c(s,"Unknown risk")},{key:"status",label:"Status",render:s=>c(s?String(s).replace("_"," ").toUpperCase():null,"Status unknown")},{key:"disposedBy",label:"Disposed By",render:(s,e)=>c(e.user?.name||e.disposedBy||e.user_name,"Unknown user")},{key:"pickupBy",label:"Pickup (Requested to / Collected by)",render:(s,e)=>{const i=e.pickupRequest||e.pickup_request||null,r=i?.chw?.name||i?.chw_name||i?.pickedBy||i?.picked_by||i?.collected_by||i?.collected_by_name||i?.assigned_to?.name||i?.requested_to?.name||i?.requested_to||e.pickedBy||e.picked_by||null;if(!r&&i)return n.jsx("div",{className:"text-sm",children:"Pickup requested (unassigned)"});if(!r)return"No pickup requested";const d=i?.status||i?.state||null;return n.jsxs("div",{className:"text-sm",children:[n.jsxs("div",{children:["CHW: ",c(r,"Unassigned")]}),d&&n.jsx("div",{className:"text-xs text-gray-600",children:String(d).replace("_"," ").toUpperCase()})]})}},{key:"createdAt",label:"Submitted",render:s=>s?new Date(s).toLocaleString():"Date unknown"}];return n.jsxs("div",{className:"p-4 lg:p-8 pb-24 lg:pb-8",children:[n.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[n.jsx("h1",{className:"text-2xl font-bold",children:"Disposals"}),n.jsx(u,{to:"/admin",className:"text-sm text-primary-blue",children:"Back"})]}),n.jsx("div",{className:"card",children:k?n.jsx("div",{className:"p-8 text-center",children:"Loading..."}):n.jsx(b,{columns:g,data:p,actions:s=>n.jsx(u,{to:`/admin/disposals/${s.id}`,className:"btn-outline text-sm",children:"View"})})})]})}export{q as default};
