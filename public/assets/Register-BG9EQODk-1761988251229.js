import{u as y,r as i,j as e,U as w,t as N,v as b,x as k,y as P,z as C,A as S,L as A}from"./vendor_react-CK1M0B1O-1761988251229.js";import{I as t}from"./Input-BvYti0rl-1761988251229.js";import{l as D,a as q}from"./index-BPH-ltX_-1761988251229.js";import"./vendor_misc-i1ZNofER-1761988251229.js";import"./vendor_axios-ngrFHoWO-1761988251229.js";function I(){const d=y(),[c,m]=i.useState(!1),[u,s]=i.useState(""),[x,g]=i.useState(""),[a,f]=i.useState({name:"",email:"",password:"",confirmPassword:"",phone:"",location:"",sector:"",role:"user"}),r=n=>{const{name:p,value:o}=n.target;f({...a,[p]:o}),s("")},v=async n=>{if(n.preventDefault(),s(""),g(""),a.password!==a.confirmPassword){s("Passwords do not match");return}if(a.password.length<6){s("Password must be at least 6 characters long");return}const o=a.email.split("@")[1]==="umutisafe.gov.rw";if(a.role==="admin"){if(!o){s("Administrator accounts must use @umutisafe.gov.rw email address");return}}else if(o){s("The @umutisafe.gov.rw domain is reserved for administrators only. Please use a different email address.");return}m(!0);try{const{confirmPassword:h,...j}=a,l=await q.register(j);l.success&&(g(l.message),l.data.user.isApproved?setTimeout(()=>{d("/login")},2e3):setTimeout(()=>{d("/login",{state:{message:"Registration successful! Your account is pending approval. You will receive an email once approved."}})},3e3))}catch(h){s(h.response?.data?.message||"Registration failed. Please try again.")}finally{m(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary-blue to-primary-green p-4",children:e.jsxs("div",{className:"card max-w-2xl w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("img",{src:D,alt:"UmutiSafe Logo",className:"w-20 h-20 mx-auto mb-4"}),e.jsx("h1",{className:"text-3xl font-bold text-text-dark dark:text-text-light mb-2",children:"Create Account"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Join UmutiSafe - Safe Medicine Disposal Platform"})]}),u&&e.jsx("div",{className:"mb-4 p-4 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 rounded-lg",children:u}),x&&e.jsx("div",{className:"mb-4 p-4 bg-green-100 dark:bg-green-900/30 border border-green-400 dark:border-green-700 text-green-700 dark:text-green-400 rounded-lg",children:x}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(t,{label:"Full Name",id:"name",name:"name",type:"text",value:a.name,onChange:r,placeholder:"John Doe",required:!0,icon:w}),e.jsx(t,{label:"Email",id:"email",name:"email",type:"email",value:a.email,onChange:r,placeholder:"your.email@example.com",required:!0,icon:N})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(t,{label:"Password",id:"password",name:"password",type:"password",value:a.password,onChange:r,placeholder:"At least 6 characters",required:!0,icon:b}),e.jsx(t,{label:"Confirm Password",id:"confirmPassword",name:"confirmPassword",type:"password",value:a.confirmPassword,onChange:r,placeholder:"Re-enter password",required:!0,icon:b})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(t,{label:"Phone Number",id:"phone",name:"phone",type:"tel",value:a.phone,onChange:r,placeholder:"+250 788 123 456",icon:k}),e.jsx(t,{label:"Location",id:"location",name:"location",type:"text",value:a.location,onChange:r,placeholder:"Kigali, Gasabo",icon:P})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Account Type"}),e.jsxs("select",{id:"role",name:"role",value:a.role,onChange:r,className:"input-field w-full",required:!0,children:[e.jsx("option",{value:"user",children:"Household User"}),e.jsx("option",{value:"admin",children:"Administrator"})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:a.role==="user"?"For individuals disposing of medicines at home":"For system administrators (requires approval)"})]}),a.role==="user"&&e.jsxs("div",{children:[e.jsx(t,{label:"Sector",id:"sector",name:"sector",type:"text",value:a.sector,onChange:r,placeholder:"e.g., Kimironko, Remera, Nyarutarama",icon:C,required:!0}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Your sector helps us connect you with Community Health Workers in your area"})]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-300",children:[e.jsx("strong",{children:"Note:"})," Your account will be pending approval by an administrator. You will receive an email notification once your account is approved and you can log in."]})}),e.jsx("button",{type:"submit",className:"btn-primary w-full flex items-center justify-center gap-2",disabled:c,children:c?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Creating Account..."]}):e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"w-5 h-5"}),"Create Account"]})})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Already have an account?"," ",e.jsx(A,{to:"/login",className:"text-primary-blue dark:text-accent-cta hover:underline font-medium",children:"Sign In"})]})}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Need help?"," ",e.jsx("a",{href:"tel:+250788000000",className:"text-primary-blue dark:text-accent-cta hover:underline",children:"Call +250 788 000 000"})]})})]})})}export{I as default};
